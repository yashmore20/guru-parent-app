<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guru.ai - Parent Portal</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- ======== LOGIN PAGE ======== -->
    <div id="login-page" class="page active">
        <div class="auth-container">
            <div class="auth-logo">
                <div class="logo-icon">G</div>
                <h1>Guru.ai</h1>
                <p class="tagline">Parent Portal</p>
            </div>
            <div class="auth-tabs">
                <button class="tab-btn active" data-tab="login-tab">Login</button>
                <button class="tab-btn" data-tab="signup-tab">Sign Up</button>
                <button class="tab-btn" data-tab="setpw-tab">Set Password</button>
            </div>

            <!-- Login Tab -->
            <div id="login-tab" class="tab-content active">
                <form id="login-form">
                    <div class="form-group">
                        <label for="login-email">Email</label>
                        <input type="email" id="login-email" placeholder="parent@email.com" required>
                    </div>
                    <div class="form-group">
                        <label for="login-password">Password</label>
                        <input type="password" id="login-password" placeholder="Enter password" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">
                        <span class="btn-text">Login</span>
                        <span class="btn-loading" style="display:none;">Logging in...</span>
                    </button>
                </form>
            </div>

            <!-- Signup Tab -->
            <div id="signup-tab" class="tab-content">
                <form id="signup-form">
                    <div class="form-group">
                        <label for="signup-name">Full Name</label>
                        <input type="text" id="signup-name" placeholder="Your name" required>
                    </div>
                    <div class="form-group">
                        <label for="signup-email">Email</label>
                        <input type="email" id="signup-email" placeholder="parent@email.com" required>
                    </div>
                    <div class="form-group">
                        <label for="signup-phone">Phone (optional)</label>
                        <input type="tel" id="signup-phone" placeholder="+91 98765 43210">
                    </div>
                    <div class="form-group">
                        <label for="signup-password">Password (min 6 chars)</label>
                        <input type="password" id="signup-password" placeholder="Create password" minlength="6" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">
                        <span class="btn-text">Create Account</span>
                        <span class="btn-loading" style="display:none;">Creating...</span>
                    </button>
                </form>
            </div>

            <!-- Set Password Tab (legacy accounts) -->
            <div id="setpw-tab" class="tab-content">
                <p class="tab-description">For accounts created before authentication was added.</p>
                <form id="setpw-form">
                    <div class="form-group">
                        <label for="setpw-email">Email</label>
                        <input type="email" id="setpw-email" placeholder="Your existing email" required>
                    </div>
                    <div class="form-group">
                        <label for="setpw-password">New Password (min 6 chars)</label>
                        <input type="password" id="setpw-password" placeholder="Choose password" minlength="6" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">
                        <span class="btn-text">Set Password</span>
                        <span class="btn-loading" style="display:none;">Setting...</span>
                    </button>
                </form>
            </div>

            <div id="auth-error" class="msg msg-error" style="display:none;"></div>
            <div id="auth-success" class="msg msg-success" style="display:none;"></div>
        </div>
    </div>

    <!-- ======== DASHBOARD ======== -->
    <div id="dashboard-page" class="page">
        <nav class="navbar">
            <div class="nav-left">
                <div class="nav-logo">Guru.ai</div>
            </div>
            <div class="nav-right">
                <span id="nav-parent-name" class="nav-name"></span>
                <button id="logout-btn" class="btn btn-small btn-outline">Logout</button>
            </div>
        </nav>
        <div class="container">
            <h1 class="page-title">Welcome, <span id="welcome-name"></span>!</h1>

            <div class="stats-grid">
                <div class="stat-card stat-blue">
                    <div class="stat-number" id="stat-students">0</div>
                    <div class="stat-label">Students</div>
                </div>
                <div class="stat-card stat-brown">
                    <div class="stat-number" id="stat-textbooks">0</div>
                    <div class="stat-label">Textbooks</div>
                </div>
                <div class="stat-card stat-green">
                    <div class="stat-number" id="stat-homework">0</div>
                    <div class="stat-label">Homework</div>
                </div>
                <div class="stat-card stat-purple">
                    <div class="stat-number" id="stat-sessions">0</div>
                    <div class="stat-label">Sessions</div>
                </div>
            </div>

            <div class="quick-actions">
                <button class="action-card" onclick="showPage('students-page')">
                    <span class="action-icon">&#128101;</span>
                    <span class="action-label">Students</span>
                </button>
                <button class="action-card" onclick="showPage('textbooks-page')">
                    <span class="action-icon">&#128218;</span>
                    <span class="action-label">Textbooks</span>
                </button>
                <button class="action-card" onclick="showPage('homework-page')">
                    <span class="action-icon">&#9999;&#65039;</span>
                    <span class="action-label">Homework</span>
                </button>
                <button class="action-card" onclick="showPage('summaries-page')">
                    <span class="action-icon">&#128202;</span>
                    <span class="action-label">Summaries</span>
                </button>
                <button class="action-card" onclick="showPage('pairing-page')">
                    <span class="action-icon">&#128241;</span>
                    <span class="action-label">Pair Device</span>
                </button>
            </div>
        </div>
    </div>

    <!-- ======== STUDENTS PAGE ======== -->
    <div id="students-page" class="page">
        <nav class="navbar">
            <div class="nav-left">
                <button class="btn btn-small btn-outline" onclick="showPage('dashboard-page')">&#8592; Back</button>
                <div class="nav-logo">Students</div>
            </div>
            <div class="nav-right">
                <button class="btn btn-small btn-outline" onclick="logout()">Logout</button>
            </div>
        </nav>
        <div class="container">
            <div id="student-limit-msg" class="msg msg-info" style="display:none;"></div>

            <div class="card" id="add-student-section">
                <h2>Add Student</h2>
                <form id="add-student-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="student-name">Name</label>
                            <input type="text" id="student-name" placeholder="Child's name" required>
                        </div>
                        <div class="form-group">
                            <label for="student-class">Class</label>
                            <select id="student-class" required>
                                <option value="">Select</option>
                                <option value="Class 2">Class 2</option>
                                <option value="Class 3">Class 3</option>
                                <option value="Class 4">Class 4</option>
                                <option value="Class 5">Class 5</option>
                                <option value="Class 6">Class 6</option>
                                <option value="Class 7">Class 7</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="student-board">Board</label>
                            <select id="student-board">
                                <option value="CBSE">CBSE</option>
                                <option value="ICSE">ICSE</option>
                                <option value="State Board">State Board</option>
                            </select>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <span class="btn-text">Add Student</span>
                        <span class="btn-loading" style="display:none;">Adding...</span>
                    </button>
                </form>
                <div id="add-student-error" class="msg msg-error" style="display:none;"></div>
            </div>

            <div id="students-list" class="list-container">
                <div class="loading">Loading students...</div>
            </div>
        </div>
    </div>

    <!-- ======== TEXTBOOKS PAGE ======== -->
    <div id="textbooks-page" class="page">
        <nav class="navbar">
            <div class="nav-left">
                <button class="btn btn-small btn-outline" onclick="showPage('dashboard-page')">&#8592; Back</button>
                <div class="nav-logo">Textbooks</div>
            </div>
            <div class="nav-right">
                <button class="btn btn-small btn-outline" onclick="logout()">Logout</button>
            </div>
        </nav>
        <div class="container">
            <div class="card">
                <h2>Upload Textbook (PDF)</h2>
                <form id="upload-textbook-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="tb-book-name">Book Name</label>
                            <input type="text" id="tb-book-name" placeholder="e.g. NCERT Maths" required>
                        </div>
                        <div class="form-group">
                            <label for="tb-subject">Subject</label>
                            <select id="tb-subject" required>
                                <option value="">Select</option>
                                <option value="Mathematics">Mathematics</option>
                                <option value="Science">Science</option>
                                <option value="English">English</option>
                                <option value="Hindi">Hindi</option>
                                <option value="Social Studies">Social Studies</option>
                                <option value="EVS">EVS</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="tb-class">Class</label>
                            <select id="tb-class" required>
                                <option value="">Select</option>
                                <option value="Class 2">Class 2</option>
                                <option value="Class 3">Class 3</option>
                                <option value="Class 4">Class 4</option>
                                <option value="Class 5">Class 5</option>
                                <option value="Class 6">Class 6</option>
                                <option value="Class 7">Class 7</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="tb-file">PDF File</label>
                        <input type="file" id="tb-file" accept=".pdf" required>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <span class="btn-text">Upload Textbook</span>
                        <span class="btn-loading" style="display:none;">Uploading...</span>
                    </button>
                </form>
                <div id="upload-progress" class="progress-bar" style="display:none;">
                    <div class="progress-fill"></div>
                </div>
                <div id="upload-error" class="msg msg-error" style="display:none;"></div>
                <div id="upload-success" class="msg msg-success" style="display:none;"></div>
            </div>

            <div id="textbooks-list" class="list-container">
                <div class="loading">Loading textbooks...</div>
            </div>
        </div>
    </div>

    <!-- ======== HOMEWORK PAGE ======== -->
    <div id="homework-page" class="page">
        <nav class="navbar">
            <div class="nav-left">
                <button class="btn btn-small btn-outline" onclick="showPage('dashboard-page')">&#8592; Back</button>
                <div class="nav-logo">Homework</div>
            </div>
            <div class="nav-right">
                <button class="btn btn-small btn-outline" onclick="logout()">Logout</button>
            </div>
        </nav>
        <div class="container">
            <div class="card">
                <h2>Assign Homework</h2>
                <form id="add-homework-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="hw-student">Student</label>
                            <select id="hw-student" required>
                                <option value="">Select student</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="hw-subject">Subject</label>
                            <select id="hw-subject" required>
                                <option value="">Select</option>
                                <option value="Mathematics">Mathematics</option>
                                <option value="Science">Science</option>
                                <option value="English">English</option>
                                <option value="Hindi">Hindi</option>
                                <option value="Social Studies">Social Studies</option>
                                <option value="General">General</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="hw-text">Homework Description</label>
                        <textarea id="hw-text" rows="3" placeholder="e.g. Complete page 45, questions 1-5" required></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <span class="btn-text">Assign Homework</span>
                        <span class="btn-loading" style="display:none;">Saving...</span>
                    </button>
                </form>
                <div id="homework-error" class="msg msg-error" style="display:none;"></div>
                <div id="homework-success" class="msg msg-success" style="display:none;"></div>
            </div>

            <h2 class="section-title">Recent Homework</h2>
            <div id="homework-list" class="list-container">
                <div class="loading">Loading homework...</div>
            </div>
        </div>
    </div>

    <!-- ======== SUMMARIES PAGE ======== -->
    <div id="summaries-page" class="page">
        <nav class="navbar">
            <div class="nav-left">
                <button class="btn btn-small btn-outline" onclick="showPage('dashboard-page')">&#8592; Back</button>
                <div class="nav-logo">Session Summaries</div>
            </div>
            <div class="nav-right">
                <button class="btn btn-small btn-outline" onclick="logout()">Logout</button>
            </div>
        </nav>
        <div class="container">
            <div class="filters-bar">
                <div class="form-group">
                    <label for="sum-student-filter">Filter by Student</label>
                    <select id="sum-student-filter">
                        <option value="">All Students</option>
                    </select>
                </div>
                <button class="btn btn-small btn-primary" onclick="loadSummaries()">Refresh</button>
            </div>

            <div id="summaries-list" class="list-container">
                <div class="loading">Loading summaries...</div>
            </div>
        </div>
    </div>

    <!-- ======== DEVICE PAIRING PAGE ======== -->
    <div id="pairing-page" class="page">
        <nav class="navbar">
            <div class="nav-left">
                <button class="btn btn-small btn-outline" onclick="showPage('dashboard-page')">&#8592; Back</button>
                <div class="nav-logo">Pair Device</div>
            </div>
            <div class="nav-right">
                <button class="btn btn-small btn-outline" onclick="logout()">Logout</button>
            </div>
        </nav>
        <div class="container">
            <div class="card pairing-card">
                <h2>Connect Your Guru Device</h2>
                <div class="pairing-instructions">
                    <div class="step">
                        <span class="step-num">1</span>
                        <span>Turn on your Guru desk device</span>
                    </div>
                    <div class="step">
                        <span class="step-num">2</span>
                        <span>A 6-digit code will appear on the device screen</span>
                    </div>
                    <div class="step">
                        <span class="step-num">3</span>
                        <span>Enter the code below and tap "Pair"</span>
                    </div>
                </div>
                <form id="pair-device-form">
                    <div class="form-group">
                        <label for="device-code">6-Digit Device Code</label>
                        <input type="text" id="device-code" placeholder="000000" maxlength="6" pattern="[0-9]{6}" inputmode="numeric" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">
                        <span class="btn-text">Pair Device</span>
                        <span class="btn-loading" style="display:none;">Pairing...</span>
                    </button>
                </form>
                <div id="pairing-error" class="msg msg-error" style="display:none;"></div>
                <div id="pairing-success" class="msg msg-success" style="display:none;"></div>
            </div>
        </div>
    </div>

    <script src="api.js"></script>
    <script src="auth.js"></script>
    <script src="app.js"></script>
</body>
</html>
